#!/usr/bin/env bash

# Tell this script to exit if there are any errors.
# You should have this in every custom script, to ensure that your completed
# builds actually ran successfully without any errors!
set -oue pipefail

rpm-ostree install just rustc libglvnd-devel wayland-devel libseat-devel libxkbcommon-devel libinput-devel gtk4-devel udev dbus dbus-devel
# optional dependencies
rpm-ostree install systemd-devel pulseaudio-libs-devel expat-devel fontconfig-devel freetype-devel lld cargo libgbm-devel clang-devel pipewire-devel

git clone --recurse-submodules https://github.com/pop-os/cosmic-epoch
cd cosmic-epoch
just sysext

mkdir /etc/cosmic-comp
cp cosmic-comp/config.ron /etc/cosmic-comp
cp ./cosmic-sysext/usr /usr
#cp ./cosmic-sysext /var/lib/extensions